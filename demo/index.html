<!doctype html>
<html>
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  
    <title>firebase-auth-dialog Demo</title>
  
    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  
    <link rel="import" href="../firebase-auth-dialog.html">
    <link rel="import" href="../../paper-button/paper-button.html">
    <link rel="import" href="../../paper-styles/color.html">
    <link rel="import" href="../../paper-styles/demo-pages.html">
    <link rel="import" href="../../neon-animation/animations/scale-up-animation.html">
    <link rel="import" href="../../neon-animation/animations/fade-out-animation.html">
  
    <link rel="stylesheet" href="../../paper-styles/demo.css">

    <style is="custom-style">
      section > paper-button {
        background-color: var(--google-grey-300);
        padding: 5px;
      }

      section > paper-button:hover {
        background-color: var(--paper-light-blue-200);
        padding: 5px;
      }

      firebase-auth-dialog.colored {
        border: 2px solid;
        border-color: var(--paper-green-500);
        background-color: var(--paper-light-green-50);
        color: var(--paper-green-500);
      }

      firebase-auth-dialog.size-position {
        position: fixed;
        top: 16px;
        right: 16px;
        width: 300px;
        height: 300px;
        overflow: auto;
      }
    </style>

  </head>
  <body unresolved>

    <section onclick="clickHandler(event)">

      <paper-button data-dialog="Register">Register Dialog</paper-button>
      <paper-button data-dialog="Login">Login Dialog</paper-button>
    
      <!-- TODO PG: Add a selection check box to add the services used -->

      <firebase-auth-dialog id="firebaseAuthDialog"
        entry-animation="scale-up-animation"
        exit-animation="fade-out-animation"
        type="Register"
        location="https://metanov-test.firebaseio.com"
        providers='["facebook", "github", "google"]'
        modal
        with-backdrop
        >
      </firebase-auth-dialog>

      <!-- TODO PG: add user info report -->
      <h3>Register status:</h3>
      <p id="register"></p>

      <h3>Login status:</h3>
      <pre id="login"></pre>

      <h3>User</h3>
      <pre id="user"></pre>

      <h3>Error status:</h3>
      <pre id="error"></pre>

    </section>

    <script>
      window.addEventListener('login', loginHandler);
      window.addEventListener('user-created', registerHandler);
      window.addEventListener('error', errorHandler);

      function registerHandler(e) {
        var register = document.getElementById("register");
        register.innerText = "Registered";
        // FIXME PG: not additional user ID provided in the event...
        // https://github.com/GoogleWebComponents/firebase-element/issues/74

        // var user = document.getElementById("user");
        // user.innerHTML = JSON.stringify(e.detail);
      }

      function loginHandler(e) {
        var login = document.getElementById("login");
        login.innerText = "Logged In";
        var user = document.getElementById("user");
        user.innerHTML = JSON.stringify(e.detail.user);
      }

      function errorHandler(e) {
        var error = document.getElementById("error");
        user.innerHTML = JSON.stringify(e.detail);
      }

      function clickHandler(e) {
        var button = e.target;
        while (!button.hasAttribute('data-dialog') && button !== document.body) {
          button = button.parentElement;
        }
        if (!button.hasAttribute('data-dialog')) {
          return;
        }

        var register = document.getElementById("register");
        register.innerText = "";
        var login = document.getElementById("login");
        login.innerText = "";
        var user = document.getElementById("user");
        user.innerHTML = "";
        var error = document.getElementById("error");
        user.innerHTML = "";

        var dialog = document.getElementById("firebaseAuthDialog");
        
        if (dialog) {
          var type = button.getAttribute('data-dialog');
          dialog.setAttribute('type', type);
          dialog.open();
        }
      }
    </script>

  </body>
</html>
